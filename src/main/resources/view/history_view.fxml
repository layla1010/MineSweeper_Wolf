<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import java.net.URL?>
<?import javafx.collections.FXCollections?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane fx:id="root" prefHeight="750.0" prefWidth="1200.0" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="control.HistoryController">

    <!-- Root style class -->
    <styleClass>
        <String fx:value="history-root" />
        <String fx:value="themed-bg" />
    </styleClass>

    <!-- ===== TOP: title + filter + sort ===== -->
    <top>
        <VBox spacing="18.0" BorderPane.alignment="TOP_CENTER">
            <padding>
                <Insets left="40.0" right="40.0" top="25.0" />
            </padding>

            <!-- Title row -->
            <HBox alignment="CENTER_LEFT">
                <children>

                    <!-- Back -->
                    <Button fx:id="backBtn" mnemonicParsing="false" onAction="#onBackButtonClicked" prefHeight="40.0" prefWidth="50.0" text="←" textFill="WHITE">
                        <styleClass>
                            <String fx:value="history-back-button" />
                        </styleClass>
                        <font>
                            <Font name="Copperplate Gothic Bold" size="20.0" />
                        </font>
                    </Button>

                    <!-- Title -->
                    <Label alignment="CENTER" contentDisplay="CENTER" text="History" textFill="WHITE">
                        <styleClass>
                            <String fx:value="history-title" />
                        </styleClass>
                        <HBox.margin>
                            <Insets left="400.0" />
                        </HBox.margin>
                        <font>
                            <Font name="Copperplate Gothic Bold" size="48.0" />
                        </font>
                    </Label>
               <Button fx:id="soundButton" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" mnemonicParsing="false" onAction="#onSoundOff" prefHeight="44.0" prefWidth="55.0" style="-fx-background-color: TRANSPARENT;">
                  <graphic>
                     <ImageView fitHeight="49.0" fitWidth="59.0" pickOnBounds="true" preserveRatio="true">
                        <image>
                           <Image url="@/Images/volume.png" />
                        </image>
                     </ImageView>
                  </graphic>
                  <HBox.margin>
                     <Insets left="350.0" />
                  </HBox.margin>
               </Button>
               <Button fx:id="musicButton" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" mnemonicParsing="false" onAction="#onMusicToggle" prefHeight="44.0" prefWidth="55.0" style="-fx-background-color: TRANSPARENT;">
                  <graphic>
                     <ImageView fitHeight="49.0" fitWidth="59.0" pickOnBounds="true" preserveRatio="true">
                        <image>
                           <Image url="@/Images/music.png" />
                        </image>
                     </ImageView>
                  </graphic>
                  <HBox.margin>
                     <Insets />
                  </HBox.margin>
               </Button>

                </children>
            </HBox>

            <!-- Filter + Sort row -->
            <HBox alignment="CENTER_LEFT" spacing="12.0">
                <styleClass>
                    <String fx:value="history-filter-bar" />
                </styleClass>

                <children>

                    <!-- FILTER SIDE -->
                    <Label minWidth="70.0" text="Filter by:">
                        <styleClass>
                            <String fx:value="history-filter-label" />
                        </styleClass>
                    </Label>

                    <ComboBox fx:id="filterTypeCombo" onAction="#onFilterTypeChanged" prefWidth="170.0">
                        <styleClass>
                            <String fx:value="history-glass-input" />
                        </styleClass>
                        <items>
                            <FXCollections fx:factory="observableArrayList">
                                <String fx:value="All" />
                                <String fx:value="Player name" />
                                <String fx:value="Difficulty" />
                                <String fx:value="Result" />
                                <String fx:value="Date" />
                            </FXCollections>
                        </items>
                    </ComboBox>

                    <TextField fx:id="filterValueField" prefWidth="150.0" promptText="Enter value...">
                        <styleClass>
                            <String fx:value="history-glass-input" />
                        </styleClass>
                    </TextField>

                    <DatePicker fx:id="dateFilterPicker" disable="true" prefWidth="180.0">
                        <styleClass>
                            <String fx:value="history-glass-input" />
                        </styleClass>
                    </DatePicker>

                    <Button fx:id="applyBtn" onAction="#onFilterApplyClicked" prefWidth="80.0" text="Apply">
                        <styleClass>
                            <String fx:value="history-small-button" />
                        </styleClass>
                    </Button>

                    <!-- space filler -->
                    <Region HBox.hgrow="ALWAYS" />

                    <!-- SORT SIDE -->
                    <Label minWidth="60.0" text="Sort by:">
                        <styleClass>
                            <String fx:value="history-filter-label" />
                        </styleClass>
                    </Label>

                    <ComboBox fx:id="sortTypeCombo" prefWidth="230.0">
                        <styleClass>
                            <String fx:value="history-glass-input" />
                        </styleClass>
                        <items>
                            <FXCollections fx:factory="observableArrayList">
                                <String fx:value="None" />
                                <String fx:value="Score (high → low)" />
                                <String fx:value="Score (low → high)" />
                                <String fx:value="Date (newest)" />
                                <String fx:value="Date (oldest)" />
                                <String fx:value="Duration (long → short)" />
                                <String fx:value="Duration (short → long)" />
                            </FXCollections>
                        </items>
                    </ComboBox>
					<Button fx:id="sortBtn" onAction="#onSortBtnClicked" prefWidth="80.0" text="Sort">
						<styleClass>
							<String fx:value="history-small-button" />
						</styleClass>
					</Button>

					<ImageView fx:id="refreshIcon" fitHeight="26.0" fitWidth="33.0" onMouseClicked="#onClearFilterClicked" pickOnBounds="true" preserveRatio="true" style="-fx-cursor: hand;">
						<styleClass>
							<String fx:value="clickable-icon" />
						</styleClass>
						<image>
							<Image url="@/Images/refresh.png" />
						</image>
					</ImageView>
                </children>
            </HBox>

        </VBox>
    </top>

    <!-- ===== CENTER: scrollable list of cards ===== -->
    <center>
        <ScrollPane fitToWidth="true" pannable="true" BorderPane.alignment="CENTER">
            <styleClass>
                <String fx:value="history-scroll" />
            </styleClass>

            <content>
                <VBox fx:id="historyList" spacing="15.0">
                    <styleClass>
                        <String fx:value="history-list" />
                    </styleClass>
                    <!-- cards are added here in HistoryController -->
                </VBox>
            </content>
        </ScrollPane>
    </center>

    <!-- Screen-specific stylesheet ONLY -->
    <stylesheets>
        <URL value="@../css/history.css" />
    </stylesheets>

</BorderPane>
